<div class="singleMovie" *ngIf="uniqueMovie$ | async as movie">
  <!-- Movie title and release date -->
  <h3 class="singleMovie__title">{{ movie.title }}</h3>
  <div
    class="singleMovie__subTitle"
    *ngIf="uniqueMovieCredits$ | async as movieCredits"
  >
    <span class="singleMovie__subTitle__date">
      sortie le: {{ movie.release_date | date : "d MMMM yyyy" }}</span
    >
  </div>
  <!-- Main movie features (with the ticket design) -->
  <div class="singleMovie__block">
    <div class="singleMovie__block__leftPick"></div>
    <div class="singleMovie__block__rightPick"></div>

    <div class="singleMovie__block__poster">
      <img
        class="singleMovie__block__poster__image"
        [src]="
          movie.poster_path
            ? posterUrl + movie.poster_path
            : '../../assets/default_poster.png'
        "
      />
      <!-- Determining the star icons to display from the average vote -->
      <div class="singleMovie__block__poster__rating">
        <i
          class="fa-solid fa-star-half"
          *ngIf="movie.vote_average > 0 && movie.vote_average < 1"
        ></i>
        <i class="fa-solid fa-star" *ngIf="movie.vote_average >= 1"></i>
        <i
          class="fa-solid fa-star-half"
          *ngIf="movie.vote_average >= 2 && movie.vote_average < 3"
        ></i>
        <i class="fa-solid fa-star" *ngIf="movie.vote_average >= 3"></i>
        <i
          class="fa-solid fa-star-half"
          *ngIf="movie.vote_average > 4 && movie.vote_average < 5"
        ></i>
        <i class="fa-solid fa-star" *ngIf="movie.vote_average >= 5"></i>
        <i
          class="fa-solid fa-star-half"
          *ngIf="movie.vote_average > 6 && movie.vote_average < 7"
        ></i>
        <i class="fa-solid fa-star" *ngIf="movie.vote_average >= 7"></i>
        <i
          class="fa-solid fa-star-half"
          *ngIf="movie.vote_average > 8 && movie.vote_average < 9"
        ></i>
        <i class="fa-solid fa-star" *ngIf="movie.vote_average >= 9"></i>
      </div>
    </div>
    <!-- Movie description -->
    <div class="singleMovie__block__description">
      <!-- Movie overview (if available) -->
      <p class="singleMovie__block__description__overview">
        {{ movie.overview }}
      </p>
      <!-- Movie production companies (if available) -->
      <div
        class="singleMovie__block__description__production"
        *ngIf="movie.production_companies.length > 0"
      >
        <div class="singleMovie__block__description__production__producers">
          <div
            class="singleMovie__block__description__production__producers__list"
            *ngFor="let producer of movie.production_companies"
          >
            <!-- If no logo is available, displays only the production company name -->
            <img
              *ngIf="producer.logo_path"
              [src]="posterUrl + producer.logo_path"
              [alt]="producer.name + ' logo'"
            />
            <p *ngIf="!producer.logo_path">{{ producer.name }}</p>
          </div>
        </div>
      </div>
      <!-- Displays production countries (with flags) and genres associated to the movie -->
      <div class="singleMovie__block__description__countries">
        <div
          class="singleMovie__block__description__countries__list"
          *ngFor="let country of movie.production_countries"
        >
          <img
            [src]="'../../assets/flags/128x128/' + country.iso_3166_1 + '.png'"
          />
        </div>
        <div class="singleMovie__block__description__countries__genres">
          <h6 *ngFor="let genre of movie.genres">{{ genre.name }}</h6>
        </div>
      </div>
    </div>
  </div>

  <!-- Displays directors and actors -->
  <div
    class="singleMovie__crew"
    *ngIf="uniqueMovieCredits$ | async as movieCredits"
  >
    <h5>RÃ©alisation:</h5>
    <div
      class="singleMovie__crew__list"
      *ngIf="uniqueMovieCrew$ | async as movieCrew"
    >
      <div
        class="singleMovie__crew__list__member"
        *ngFor="let movieCrewMember of movieCrew; let i = index"
      >
        <!-- Limiting display to 5 members, modified by clicking the crew toggle link -->
        <div
          class="singleMovie__crew__list__member__card"
          *ngIf="crewToggle ? i < 100 : i < 5"
        >
          <div class="singleMovie__crew__list__member__card__profile">
            <img
              class="singleMovie__crew__list__member__card__profile__image"
              [src]="
                movieCrewMember.profile_path
                  ? posterUrl + movieCrewMember.profile_path
                  : '../../assets/default_profile.png'
              "
            />
          </div>

          <p class="singleMovie__crew__list__member__card__name">
            {{ movieCrewMember.name }}
          </p>
        </div>
      </div>
      <!-- Crew toggle link, displayed only if there's more than 5 directors -->
      <p class="seeMore" (click)="seeMoreCrew()" *ngIf="movieCrew.length > 5">
        {{ crewToggle ? "Voir moins..." : "Voir plus..." }}
      </p>
    </div>

    <h5>Acteurs:</h5>
    <div class="singleMovie__crew__list">
      <div
        class="singleMovie__crew__list__member"
        *ngFor="let movieCast of movieCredits.cast; let i = index"
      >
        <!-- Same as directors, displaying only 5 members (toggled by castToggle) -->
        <div
          class="singleMovie__crew__list__member__card"
          *ngIf="castToggle ? i < 100 : i < 5"
        >
          <div class="singleMovie__crew__list__member__card__profile">
            <img
              class="singleMovie__crew__list__member__card__profile__image"
              [src]="
                movieCast.profile_path
                  ? posterUrl + movieCast.profile_path
                  : '../../assets/default_profile.png'
              "
            />
          </div>

          <p class="singleMovie__crew__list__member__card__name">
            {{ movieCast.name }}
          </p>
        </div>
      </div>
      <!-- Link to toggle actors display (from 5 to all) -->
      <p class="seeMore" (click)="seeMoreCast()">
        {{ castToggle ? "Voir moins..." : "Voir plus..." }}
      </p>
    </div>
  </div>
</div>
